<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Savore | Premium Food Delivery</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

<style>
:root{
  --dark:#111111;
  --cream:#f9f5f0;
  --gold:#c6a75e;
  --orange:#fc8019;
  --orange-dark:#e96d0d;
  --white:#ffffff;
  --muted:#6f6f6f;
}

*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:'Poppins',sans-serif;
}

body{
  background:var(--cream);
  color:#333;
}

header{
  background:
    linear-gradient(rgba(0,0,0,0.70),rgba(0,0,0,0.70)),
    url('https://images.unsplash.com/photo-1482049016688-2d3e1b311543?auto=format&fit=crop&w=1600&q=70') center/cover no-repeat;
  color:white;
  padding:18px 60px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.logo{
  font-family:'Playfair Display',serif;
  font-size:28px;
  color:#ffd899;
}

nav a{
  color:white;
  margin-left:25px;
  text-decoration:none;
  cursor:pointer;
  transition:0.25s;
}

nav a:hover{
  color:#ffd899;
}

.cart-count{
  background:var(--orange);
  padding:3px 8px;
  border-radius:50%;
  font-size:12px;
  margin-left:5px;
}

.delivery-bar{
  background:#1f1f1f;
  color:white;
  padding:12px 60px;
  display:grid;
  grid-template-columns:1.2fr 2fr auto;
  gap:10px;
  align-items:center;
}

.location-pill{
  background:#2f2f2f;
  border-radius:25px;
  padding:10px 14px;
  font-size:13px;
  display:flex;
  flex-direction:column;
  line-height:1.2;
}

.location-pill strong{
  color:#ffd9b8;
}

.delivery-bar input{
  width:100%;
  padding:10px 14px;
  border-radius:25px;
  border:none;
}

.delivery-bar button{
  background:var(--orange);
  border:none;
  padding:10px 25px;
  border-radius:25px;
  color:white;
  cursor:pointer;
}

.map-modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.55);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:999;
  padding:18px;
}

.map-modal.open{
  display:flex;
}

.map-modal-card{
  width:min(900px,96vw);
  background:white;
  border-radius:14px;
  padding:16px;
}

.map-modal-head{
  display:flex;
  gap:10px;
  margin-bottom:10px;
}

.map-modal-head input{
  flex:1;
  border:1px solid #ddd;
  border-radius:10px;
  padding:10px 12px;
}

.map-modal-head button{
  border:none;
  border-radius:10px;
  padding:10px 14px;
  background:var(--orange);
  color:white;
  cursor:pointer;
}

.map-frame{
  width:100%;
  height:420px;
  border:0;
  border-radius:12px;
  margin-bottom:10px;
}

.map-modal-actions{
  display:flex;
  justify-content:flex-end;
  gap:8px;
}

.map-modal-actions button{
  border:none;
  border-radius:10px;
  padding:10px 14px;
  cursor:pointer;
}

.map-cancel{
  background:#ebebeb;
  color:#333;
}

.map-confirm{
  background:var(--orange);
  color:white;
}

.page{
  display:none;
  padding:50px 60px;
}

.active{
  display:block;
}

.hero{
  height:52vh;
  background:linear-gradient(rgba(0,0,0,0.50),rgba(0,0,0,0.50)),
  url('https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?auto=format&fit=crop&w=1600&q=70') center/cover no-repeat;
  border-radius:22px;
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  color:white;
  margin-bottom:26px;
}

.hero h1{
  font-family:'Playfair Display',serif;
  font-size:52px;
}

.hero p{
  margin-top:10px;
  font-size:18px;
}

.hero button{
  margin-top:22px;
  background:var(--orange);
  border:none;
  padding:12px 30px;
  border-radius:30px;
  color:white;
  cursor:pointer;
}

.offer-banner{
  background:linear-gradient(90deg,var(--orange),var(--orange-dark));
  color:white;
  border-radius:20px;
  padding:20px;
  margin-bottom:22px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:16px;
}

.offer-banner h3{
  font-size:24px;
}

.offer-banner p{
  font-size:14px;
}

.offer-code{
  background:white;
  color:var(--orange-dark);
  border-radius:12px;
  padding:10px 14px;
  font-weight:600;
  white-space:nowrap;
}

.filter-wrap{
  background:white;
  border-radius:18px;
  padding:16px;
  box-shadow:0 8px 20px rgba(0,0,0,0.07);
  margin-bottom:24px;
}

.filter-row{
  display:grid;
  grid-template-columns:2fr 1fr 1fr;
  gap:10px;
  margin-bottom:12px;
}

.filter-row input,
.filter-row select{
  width:100%;
  border:1px solid #ddd;
  border-radius:10px;
  padding:10px 12px;
}

.category-pills{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}

.category-pills button{
  background:#f1f1f1;
  color:#333;
  border:none;
  border-radius:999px;
  padding:7px 12px;
  cursor:pointer;
}

.category-pills button.active-pill{
  background:var(--orange);
  color:white;
}

.section-title{
  font-family:'Playfair Display',serif;
  font-size:34px;
  margin-bottom:24px;
}

.cards{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
  gap:24px;
}

.card{
  background:white;
  border-radius:20px;
  overflow:hidden;
  box-shadow:0 10px 30px rgba(0,0,0,0.08);
  transition:0.25s;
}

.card:hover{
  transform:translateY(-8px);
}

.card img{
  width:100%;
  height:200px;
  object-fit:cover;
}

.card-content{
  padding:16px;
}

.tag-row{
  display:flex;
  gap:8px;
  margin:8px 0;
  flex-wrap:wrap;
}

.tag{
  font-size:11px;
  border-radius:999px;
  padding:4px 9px;
  background:#f3f3f3;
}

.tag.veg{
  background:#e8f9ea;
  color:#167d2d;
}

.tag.non-veg{
  background:#ffe9e8;
  color:#a2261d;
}

.restaurant-meta{
  margin:8px 0;
  color:#5c5c5c;
  font-size:13px;
}

.food-desc{
  margin:6px 0 2px;
  color:#666;
  font-size:13px;
}

.rating{
  color:#e39a17;
  font-size:14px;
  margin-bottom:7px;
}

.price{
  color:#1d1d1d;
  font-weight:600;
  margin:10px 0;
}

button{
  background:var(--gold);
  border:none;
  color:white;
  padding:8px 18px;
  border-radius:20px;
  cursor:pointer;
}

.empty-state{
  background:white;
  padding:20px;
  border-radius:14px;
}

.tracking-box{
  background:white;
  border-radius:18px;
  padding:20px;
  box-shadow:0 10px 25px rgba(0,0,0,0.07);
  max-width:820px;
}

.tracking-map{
  background:linear-gradient(120deg,#ffd7b2,#ffe9d5);
  border-radius:14px;
  padding:14px;
  margin:14px 0;
  color:#333;
  font-size:14px;
}

.map-stage{
  position:relative;
  height:220px;
  border-radius:14px;
  overflow:hidden;
  background:
    radial-gradient(circle at 20% 25%,#fff7ef 0 22px,transparent 23px),
    radial-gradient(circle at 75% 30%,#fff2e5 0 30px,transparent 31px),
    radial-gradient(circle at 45% 70%,#fff5eb 0 24px,transparent 25px),
    linear-gradient(135deg,#ffe2c7,#ffd0a1);
}

.map-road{
  position:absolute;
  inset:0;
  background:
    linear-gradient(120deg,transparent 30%,rgba(255,255,255,0.72) 30% 36%,transparent 36%),
    linear-gradient(20deg,transparent 55%,rgba(255,255,255,0.72) 55% 61%,transparent 61%);
}

.map-route{
  position:absolute;
  left:10%;
  right:12%;
  top:18%;
  bottom:20%;
  border:3px dashed rgba(232,109,13,0.8);
  border-radius:24px;
}

.map-pin{
  position:absolute;
  width:24px;
  height:24px;
  border-radius:50%;
  border:3px solid white;
  box-shadow:0 8px 14px rgba(0,0,0,0.22);
}

.map-pin.restaurant{
  background:#272727;
  left:8%;
  top:16%;
}

.map-pin.user{
  background:#149241;
  right:10%;
  bottom:18%;
}

.map-pin.rider{
  background:#222;
  left:12%;
  top:20%;
  transition:left 1.6s linear, top 1.6s linear, transform 1.6s linear;
}

.map-pin.rider::after{
  content:"üèç";
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%,-54%);
  font-size:14px;
}

.map-pin.rider::before{
  content:"";
  position:absolute;
  width:34px;
  height:8px;
  background:rgba(0,0,0,0.25);
  border-radius:999px;
  left:50%;
  top:115%;
  transform:translateX(-50%);
  filter:blur(1px);
}

.map-label{
  position:absolute;
  font-size:12px;
  background:rgba(0,0,0,0.72);
  color:white;
  padding:4px 8px;
  border-radius:999px;
}

.map-label.restaurant{
  left:6%;
  top:6%;
}

.map-label.user{
  right:7%;
  bottom:6%;
}

.map-location{
  margin-top:8px;
  color:#4d4d4d;
  font-size:14px;
}

.map-speed{
  margin-top:5px;
  color:#6b6b6b;
  font-size:12px;
}

.track-meta{
  display:flex;
  justify-content:space-between;
  gap:12px;
  flex-wrap:wrap;
}

.track-status{
  font-weight:600;
}

.progress-wrap{
  height:12px;
  background:#f0f0f0;
  border-radius:999px;
  overflow:hidden;
  margin:12px 0;
}

.progress-fill{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,var(--orange),var(--orange-dark));
  transition:width 0.8s;
}

.cart-item{
  background:white;
  padding:20px;
  margin-bottom:15px;
  border-radius:15px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.cart-controls button{
  margin-left:8px;
}

.payment-box{
  margin-top:20px;
  background:white;
  padding:20px;
  border-radius:15px;
}

.payment-title{
  font-weight:600;
  margin-bottom:10px;
}

.payment-options{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
  gap:10px;
  margin-bottom:12px;
}

.payment-options label{
  display:flex;
  gap:10px;
  align-items:center;
  padding:10px;
  border:1px solid #e6e6e6;
  border-radius:10px;
  cursor:pointer;
}

.payment-options input[type="radio"]{
  accent-color:var(--orange);
}

.payment-icon{
  width:34px;
  height:34px;
  border-radius:8px;
  object-fit:cover;
}

.pay-btn{
  background:var(--orange);
}

.added-btn{
  background:#2e8b57;
}

.total{
  font-size:22px;
  margin-top:25px;
  font-weight:600;
}

footer{
  background:var(--dark);
  color:white;
  padding:32px 60px;
  margin-top:40px;
}

.footer-grid{
  display:grid;
  grid-template-columns:1.5fr 1fr 1fr;
  gap:20px;
}

.footer-grid h4{
  margin-bottom:10px;
  color:#ffd9a7;
}

.footer-grid p,
.footer-grid li{
  color:#ddd;
  font-size:14px;
  margin-bottom:7px;
  list-style:none;
}

.copyright{
  border-top:1px solid #2a2a2a;
  margin-top:16px;
  padding-top:12px;
  font-size:13px;
  color:#bdbdbd;
}

@media(max-width:900px){
  header{
    padding:18px 20px;
  }
  .delivery-bar{
    padding:12px 20px;
    grid-template-columns:1fr;
  }
  .page{
    padding:30px 20px;
  }
  .hero h1{
    font-size:38px;
  }
  .filter-row{
    grid-template-columns:1fr;
  }
  footer{
    padding:28px 20px;
  }
  .footer-grid{
    grid-template-columns:1fr;
  }
}
</style>
</head>
<body>

<header>
  <div class="logo">Savore</div>
  <nav>
    <a onclick="showPage('home')">Home</a>
    <a onclick="showPage('menu')">Menu</a>
    <a onclick="showPage('restaurants')">Restaurants</a>
    <a onclick="showPage('tracking')">Tracking</a>
    <a onclick="showPage('cart')">Cart <span class="cart-count" id="cartCount">0</span></a>
    <a href="admin-login.html">Admin</a>
    <a href="#" onclick="logoutUser()">Logout</a>
  </nav>
</header>

<div class="delivery-bar">
  <div class="location-pill">
    <span>Delivering to</span>
    <strong id="locationLabel">Koramangala, Bengaluru</strong>
  </div>
  <input type="text" id="locationInput" placeholder="Enter exact location, landmark, or flat no.">
  <button onclick="openLocationPicker()">Set Location</button>
</div>

<div class="map-modal" id="mapModal">
  <div class="map-modal-card">
    <div class="map-modal-head">
      <input id="mapSearchInput" type="text" placeholder="Search location on Google Maps (e.g. Indiranagar, Bengaluru)">
      <button onclick="searchOnMap()">Search</button>
    </div>
    <iframe id="googleMapFrame" class="map-frame" src="https://maps.google.com/maps?q=Koramangala%20Bengaluru&z=14&output=embed" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
    <div class="map-modal-actions">
      <button class="map-cancel" onclick="closeLocationPicker()">Cancel</button>
      <button class="map-confirm" onclick="confirmMapLocation()">Use This Location</button>
    </div>
  </div>
</div>

<section id="home" class="page active">
  <div class="hero">
    <div>
      <h1>Fast Delivery, Rich Flavors</h1>
      <p>Order from top restaurants with live tracking and quick checkout.</p>
      <button onclick="showPage('menu')">Explore Full Menu</button>
    </div>
  </div>

  <div class="offer-banner">
    <div>
      <h3>Flat 50% OFF up to ‚Çπ250</h3>
      <p>On first 3 orders above ‚Çπ399. Free delivery on weekend specials.</p>
    </div>
    <div class="offer-code">USE CODE: SAVORE50</div>
  </div>

  <div class="filter-wrap">
    <div class="filter-row">
      <input type="text" id="homeSearch" placeholder="Search for biryani, pizza, burger, desserts..." oninput="applyHomeFilters()">
      <select id="foodTypeFilter" onchange="applyHomeFilters()">
        <option value="all">All Types</option>
        <option value="veg">Veg</option>
        <option value="non-veg">Non Veg</option>
      </select>
      <select id="courseFilter" onchange="applyHomeFilters()">
        <option value="all">All Categories</option>
        <option value="starters">Starters</option>
        <option value="desserts">Desserts</option>
        <option value="indian">Indian</option>
        <option value="desi">Desi Foods</option>
        <option value="pizza">Pizza</option>
        <option value="burger">Burger</option>
      </select>
    </div>
    <div class="category-pills" id="categoryPills">
      <button class="active-pill" onclick="setCategory('all', this)">All</button>
      <button onclick="setCategory('veg', this)">Veg</button>
      <button onclick="setCategory('non-veg', this)">Non Veg</button>
      <button onclick="setCategory('starters', this)">Starters</button>
      <button onclick="setCategory('desserts', this)">Desserts</button>
      <button onclick="setCategory('indian', this)">Indian</button>
      <button onclick="setCategory('desi', this)">Desi Foods</button>
      <button onclick="setCategory('pizza', this)">Pizza</button>
      <button onclick="setCategory('burger', this)">Burger</button>
    </div>
  </div>

  <h2 class="section-title">Featured Food</h2>
  <div class="cards" id="homeItems"></div>
</section>

<section id="menu" class="page">
  <h2 class="section-title">Our Premium Menu</h2>
  <div class="cards" id="menuItems"></div>
</section>

<section id="restaurants" class="page">
  <h2 class="section-title">Famous Restaurants In India</h2>
  <div class="cards" id="restaurantItems"></div>
</section>

<section id="tracking" class="page">
  <h2 class="section-title">Online Delivery Tracking</h2>
  <div class="tracking-box">
    <div class="track-meta">
      <p><strong>Delivery Partner:</strong> Ravi Kumar</p>
      <p><strong>Order ID:</strong> SVR-20981</p>
      <p><strong>ETA:</strong> <span id="eta">22 mins</span></p>
    </div>
    <div class="tracking-map">
      <div class="map-stage">
        <div class="map-road"></div>
        <div class="map-route"></div>
        <div class="map-pin restaurant"></div>
        <div class="map-pin rider" id="riderPin"></div>
        <div class="map-pin user"></div>
        <div class="map-label restaurant">Restaurant</div>
        <div class="map-label user">You</div>
      </div>
      <p class="map-location" id="mapLocation">Rider is near Sony Signal, moving toward Koramangala 5th Block.</p>
    </div>
    <div class="progress-wrap">
      <div class="progress-fill" id="trackFill"></div>
    </div>
    <p class="track-status" id="trackStatus">Order accepted by restaurant</p>
    <p class="map-speed" id="mapSpeed">Bike speed: 0 km/h</p>
  </div>
</section>

<section id="cart" class="page">
  <h2 class="section-title">Your Cart</h2>
  <div id="cartItems"></div>
  <div class="total">Total: ‚Çπ<span id="totalPrice">0</span></div>
  <div class="payment-box">
    <div class="payment-title">Select Payment Method</div>
    <div class="payment-options">
      <label>
        <input type="radio" name="payment" value="UPI" checked>
        <img class="payment-icon" src="https://img.icons8.com/color/96/google-pay-india.png" alt="UPI">
        UPI
      </label>
      <label>
        <input type="radio" name="payment" value="Debit Card">
        <img class="payment-icon" src="https://img.icons8.com/color/96/bank-card-back-side.png" alt="Debit Card">
        Debit Card
      </label>
      <label>
        <input type="radio" name="payment" value="Credit Card">
        <img class="payment-icon" src="https://img.icons8.com/color/96/visa.png" alt="Credit Card">
        Credit Card
      </label>
      <label>
        <input type="radio" name="payment" value="Net Banking">
        <img class="payment-icon" src="https://img.icons8.com/color/96/bank-building.png" alt="Net Banking">
        Net Banking
      </label>
      <label>
        <input type="radio" name="payment" value="Cash on Delivery">
        <img class="payment-icon" src="https://img.icons8.com/color/96/cash-in-hand.png" alt="Cash on Delivery">
        Cash on Delivery
      </label>
    </div>
    <button class="pay-btn" onclick="placeOrder()">Pay & Place Order</button>
  </div>
</section>

<footer>
  <div class="footer-grid">
    <div>
      <h4>Savore Home</h4>
      <p>Order fresh food, desserts, pizza, burgers, and desi meals in minutes.</p>
      <p>Live order updates and easy payments in one place.</p>
    </div>
    <div>
      <h4>Top Restaurants</h4>
      <ul>
        <li>Spice Route Kitchen</li>
        <li>Tandoori Tales</li>
        <li>Burger District</li>
        <li>Pizza Junction</li>
      </ul>
    </div>
    <div>
      <h4>Help & Contact</h4>
      <ul>
        <li>Customer Support: +91 98765 43210</li>
        <li>Email: help@savore.in</li>
        <li>Open: 8 AM - 1 AM</li>
      </ul>
    </div>
  </div>
  <div class="copyright">(c) 2026 Savore | Home, Restaurants, Delivery</div>
</footer>

<script>
const RUPEE = "\u20B9";
const ADMIN_ITEMS_KEY = "savoreAdminItems";
const USER_SESSION_KEY = "savoreUserSession";

if(!localStorage.getItem(USER_SESSION_KEY)){
  window.location.href = "user-login.html";
}

const defaultMenu = [
  {id:1,name:"Paneer Tikka Skewers",price:279,img:"https://images.unsplash.com/photo-1631452180519-c014fe946bc7",type:"veg",labels:["starters","indian","desi"],rating:4.5,restaurant:"Spice Route Kitchen"},
  {id:2,name:"Chicken Malai Tikka",price:329,img:"https://rachnacooks.com/wp-content/uploads/2024/09/chickenmalaitikka1-500x500.jpg",type:"non-veg",labels:["starters","indian","desi"],rating:4.6,restaurant:"Tandoori Tales"},
  {id:3,name:"Hyderabadi Chicken Biryani",price:359,img:"https://www.licious.in/blog/wp-content/uploads/2022/06/chicken-hyderabadi-biryani-01.jpg",type:"non-veg",labels:["indian","desi"],rating:4.7,restaurant:"Tandoori Tales"},
  {id:4,name:"Dal Makhani",price:239,img:"https://images.unsplash.com/photo-1546833999-b9f581a1996d",type:"veg",labels:["indian","desi"],rating:4.4,restaurant:"Spice Route Kitchen"},
  {id:5,name:"Gulab Jamun",price:129,img:"https://static.toiimg.com/thumb/63799510.cms?imgsize=1091643&width=800&height=800",type:"veg",labels:["desserts","indian","desi"],rating:4.3,restaurant:"Sweet House"},
  {id:6,name:"Chocolate Brownie Sundae",price:189,img:"https://images.unsplash.com/photo-1551024506-0bccd828d307",type:"veg",labels:["desserts"],rating:4.2,restaurant:"Sweet House"},
  {id:7,name:"Farmhouse Veg Pizza",price:329,img:"https://images.unsplash.com/photo-1565299624946-b28f40a0ae38",type:"veg",labels:["pizza"],rating:4.4,restaurant:"Pizza Junction"},
  {id:8,name:"Pepperoni Pizza",price:389,img:"https://images.unsplash.com/photo-1513104890138-7c749659a591",type:"non-veg",labels:["pizza"],rating:4.6,restaurant:"Pizza Junction"},
  {id:9,name:"Classic Veg Burger",price:199,img:"https://images.unsplash.com/photo-1466978913421-dad2ebd01d17",type:"veg",labels:["burger"],rating:4.1,restaurant:"Burger District"},
  {id:10,name:"Smoky Chicken Burger",price:249,img:"https://images.unsplash.com/photo-1550547660-d9450f859349",type:"non-veg",labels:["burger"],rating:4.5,restaurant:"Burger District"},
  {id:11,name:"Cheese Burst Pizza",price:359,img:"https://images.unsplash.com/photo-1594007654729-407eedc4be65",type:"veg",labels:["pizza"],rating:4.5,restaurant:"Pizza Junction"},
  {id:12,name:"BBQ Chicken Pizza",price:429,img:"https://images.unsplash.com/photo-1534308983496-4fabb1a015ee",type:"non-veg",labels:["pizza"],rating:4.6,restaurant:"Pizza Junction"},
  {id:13,name:"Paneer Tandoori Pizza",price:379,img:"https://images.unsplash.com/photo-1574071318508-1cdbab80d002",type:"veg",labels:["pizza","indian"],rating:4.4,restaurant:"Spice Route Kitchen"},
  {id:14,name:"Double Patty Burger",price:279,img:"https://images.unsplash.com/photo-1572802419224-296b0aeee0d9",type:"non-veg",labels:["burger"],rating:4.5,restaurant:"Burger District"},
  {id:15,name:"Aloo Tikki Burger",price:189,img:"https://images.unsplash.com/photo-1615297928064-24977384d0da",type:"veg",labels:["burger","desi"],rating:4.2,restaurant:"Burger District"},
  {id:16,name:"Peri Peri Veg Burger",price:229,img:"https://images.unsplash.com/photo-1568901346375-23c9450c58cd",type:"veg",labels:["burger"],rating:4.3,restaurant:"Burger District"},
  {id:17,name:"Red Velvet Pastry",price:149,img:"https://images.unsplash.com/photo-1614707267537-b85aaf00c4b7",type:"veg",labels:["desserts"],rating:4.3,restaurant:"Sweet House"},
  {id:18,name:"Blueberry Cheesecake",price:219,img:"https://images.unsplash.com/photo-1533134242443-d4fd215305ad",type:"veg",labels:["desserts"],rating:4.6,restaurant:"Sweet House"},
  {id:19,name:"Mango Mousse Cup",price:169,img:"https://images.unsplash.com/photo-1488477181946-6428a0291777",type:"veg",labels:["desserts"],rating:4.4,restaurant:"Sweet House"},
  {id:20,name:"Kulfi Falooda",price:159,img:"https://media-assets.swiggy.com/swiggy/image/upload/fl_lossy,f_auto,q_auto,w_300,h_300,c_fit/FOOD_CATALOG/IMAGES/CMS/2025/3/23/1dbdbf5f-5502-48e3-95fe-af5d119a11b4_12e9d9d5-7bcf-48a8-8430-c5902f9645cd.jpeg",type:"veg",labels:["desserts","indian","desi"],rating:4.5,restaurant:"Sweet House"},
  {id:21,name:"Masala Dosa",price:149,img:"https://images.unsplash.com/photo-1668236543090-82eba5ee5976",type:"veg",labels:["indian","desi"],rating:4.6,restaurant:"South Spice House"},
  {id:22,name:"Idly Sambar",price:99,img:"https://sapanarestaurant.com/wp-content/uploads/2019/11/idli-sambar-900x600.jpg",type:"veg",labels:["indian","desi"],rating:4.5,restaurant:"South Spice House"},
  {id:23,name:"Medu Vada",price:109,img:"https://images.unsplash.com/photo-1630383249896-424e482df921",type:"veg",labels:["indian","desi","starters"],rating:4.4,restaurant:"South Spice House"},
  {id:24,name:"Bisi Bele Bath",price:169,img:"https://images.unsplash.com/photo-1512058564366-18510be2db19",type:"veg",labels:["indian","desi"],rating:4.5,restaurant:"South Spice House"}
];

const restaurants = [
  {
    name: "Bukhara",
    city: "New Delhi",
    cuisine: "North Indian, Kebabs",
    rating: 4.8,
    image: "https://images.unsplash.com/photo-1514933651103-005eec06c04b",
    description: "Known for iconic tandoori dishes and rich North Indian flavors."
  },
  {
    name: "Indian Accent",
    city: "New Delhi",
    cuisine: "Modern Indian",
    rating: 4.7,
    image: "https://images.unsplash.com/photo-1555396273-367ea4eb4db5",
    description: "Fine-dining destination blending Indian ingredients with global techniques."
  },
  {
    name: "Karavalli",
    city: "Bengaluru",
    cuisine: "Coastal Indian",
    rating: 4.7,
    image: "https://images.unsplash.com/photo-1414235077428-338989a2e8c0",
    description: "Famous for authentic coastal curries and seafood specialties."
  },
  {
    name: "Britannia & Co.",
    city: "Mumbai",
    cuisine: "Parsi, Irani",
    rating: 4.6,
    image: "https://images.unsplash.com/photo-1515003197210-e0cd71810b5f",
    description: "Historic Mumbai favorite popular for berry pulao and classic Parsi dishes."
  },
  {
    name: "Peter Cat",
    city: "Kolkata",
    cuisine: "Continental, Indian",
    rating: 4.5,
    image: "https://images.unsplash.com/photo-1552566626-52f8b828add9",
    description: "One of Kolkata's most loved legacy restaurants, known for chelo kebab."
  },
  {
    name: "Peshawri",
    city: "Mumbai",
    cuisine: "North-West Frontier",
    rating: 4.6,
    image: "https://images.unsplash.com/photo-1559339352-11d035aa65de",
    description: "Premium dining with signature grilled meats and rustic tandoor breads."
  }
];

function loadAdminItems(){
  try{
    const parsed = JSON.parse(localStorage.getItem(ADMIN_ITEMS_KEY) || "[]");
    if(!Array.isArray(parsed)) return [];
    return parsed
      .filter(item => item && item.name && item.price >= 0 && item.img)
      .map(item => ({
        id: Number(item.id),
        name: String(item.name),
        price: Number(item.price),
        img: String(item.img),
        type: item.type === "non-veg" ? "non-veg" : "veg",
        labels: Array.isArray(item.labels) && item.labels.length ? item.labels : ["indian"],
        rating: Number(item.rating) || 4.0,
        restaurant: item.restaurant ? String(item.restaurant) : "Partner Restaurant",
        description: item.description ? String(item.description) : ""
      }));
  }catch(e){
    return [];
  }
}

const menu = [...defaultMenu, ...loadAdminItems()];
let cart = [];
let activeCategory = "all";
let menuRendered = false;
let restaurantsRendered = false;

function logoutUser(){
  localStorage.removeItem(USER_SESSION_KEY);
  window.location.href = "user-login.html";
}

function showPage(id){
  document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  if(id === "menu" && !menuRendered){
    renderMenu();
    menuRendered = true;
  }
  if(id === "restaurants" && !restaurantsRendered){
    renderRestaurants();
    restaurantsRendered = true;
  }
}

function updateLocation(){
  openLocationPicker();
}

function openLocationPicker(){
  const modal = document.getElementById("mapModal");
  const input = document.getElementById("locationInput");
  const mapSearchInput = document.getElementById("mapSearchInput");
  const current = input.value.trim() || document.getElementById("locationLabel").textContent.trim();

  mapSearchInput.value = current;
  modal.classList.add("open");
  updateMapFrame(current);
}

function closeLocationPicker(){
  document.getElementById("mapModal").classList.remove("open");
}

function updateMapFrame(query){
  const frame = document.getElementById("googleMapFrame");
  const safeQuery = encodeURIComponent(query || "Bengaluru");
  frame.src = `https://maps.google.com/maps?q=${safeQuery}&z=15&output=embed`;
}

function searchOnMap(){
  const q = document.getElementById("mapSearchInput").value.trim();
  if(!q) return;
  updateMapFrame(q);
}

function confirmMapLocation(){
  const picked = document.getElementById("mapSearchInput").value.trim();
  if(!picked){
    alert("Please search and select a location first.");
    return;
  }

  document.getElementById("locationLabel").textContent = picked;
  document.getElementById("locationInput").value = picked;
  closeLocationPicker();
}

function setCategory(category, el){
  activeCategory = category;
  document.querySelectorAll("#categoryPills button").forEach(btn=>btn.classList.remove("active-pill"));
  el.classList.add("active-pill");
  applyHomeFilters();
}

function getFilteredHomeItems(){
  const text = document.getElementById("homeSearch").value.trim().toLowerCase();
  const type = document.getElementById("foodTypeFilter").value;
  const course = document.getElementById("courseFilter").value;

  return menu.filter(item=>{
    const labelText = item.labels.join(" ");
    const metaText = `${item.name} ${item.restaurant}`.toLowerCase();
    const matchesText = !text || metaText.includes(text) || labelText.includes(text);
    const matchesType = type === "all" || item.type === type;
    const matchesCourse = course === "all" || item.labels.includes(course);
    const matchesCategory = activeCategory === "all" || item.type === activeCategory || item.labels.includes(activeCategory);
    return matchesText && matchesType && matchesCourse && matchesCategory;
  });
}

function renderStars(rating){
  const full = Math.floor(rating);
  const half = rating % 1 >= 0.5 ? 1 : 0;
  const empty = 5 - full - half;
  return `${"\u2605".repeat(full)}${half ? "\u272E" : ""}${"\u2606".repeat(empty)} ${rating.toFixed(1)}`;
}

function optimizeImageUrl(url, width){
  if(!url || typeof url !== "string") return url;
  if(url.includes("unsplash.com")){
    const hasQuery = url.includes("?");
    return `${url}${hasQuery ? "&" : "?"}auto=format&fit=crop&w=${width}&q=70`;
  }
  return url;
}

function renderItems(containerId, items){
  const container = document.getElementById(containerId);
  container.innerHTML = "";

  if(!items.length){
    container.innerHTML = '<div class="empty-state">No items found for this filter. Try changing the search or category.</div>';
    return;
  }

  items.forEach(item=>{
    const tags = [item.type, ...item.labels.slice(0,2)];
    const inCart = cart.some(c=>c.id===item.id);
    container.innerHTML += `
      <div class="card">
        <img src="${optimizeImageUrl(item.img, 780)}" alt="${item.name}" loading="lazy" decoding="async">
        <div class="card-content">
          <h3>${item.name}</h3>
          <small>${item.restaurant}</small>
          ${item.description ? `<p class="food-desc">${item.description}</p>` : ""}
          <div class="tag-row">
            ${tags.map(tag=>`<span class="tag ${tag}">${tag}</span>`).join("")}
          </div>
          <div class="rating">${renderStars(item.rating)}</div>
          <div class="price">${RUPEE}${item.price.toFixed(2)}</div>
          <button class="${inCart ? "added-btn" : ""}" onclick="addToCart(${item.id})">${inCart ? "Added to Cart" : "Add to Cart"}</button>
        </div>
      </div>
    `;
  });
}

function refreshItemCards(){
  applyHomeFilters();
  if(menuRendered){
    renderMenu();
  }
}

function renderRestaurants(){
  const container = document.getElementById("restaurantItems");
  if(!container) return;
  container.innerHTML = "";

  restaurants.forEach(item=>{
    container.innerHTML += `
      <div class="card">
        <img src="${optimizeImageUrl(item.image, 780)}" alt="${item.name}" loading="lazy" decoding="async">
        <div class="card-content">
          <h3>${item.name}</h3>
          <p class="restaurant-meta">${item.city} | ${item.cuisine}</p>
          <div class="rating">${renderStars(item.rating)}</div>
          <p class="restaurant-meta">${item.description}</p>
        </div>
      </div>
    `;
  });
}

function applyHomeFilters(){
  renderItems("homeItems", getFilteredHomeItems());
}

function renderMenu(){
  renderItems("menuItems", menu);
}

function addToCart(id){
  const item = menu.find(m=>m.id===id);
  if(!item) return;
  const exist = cart.find(c=>c.id===id);
  if(exist) exist.qty++;
  else cart.push({...item, qty:1});
  updateCart();
  refreshItemCards();
}

function updateCart(){
  const cartDiv = document.getElementById("cartItems");
  const count = document.getElementById("cartCount");
  const totalSpan = document.getElementById("totalPrice");

  cartDiv.innerHTML = "";
  let total = 0;
  let items = 0;

  cart.forEach(item=>{
    total += item.price * item.qty;
    items += item.qty;
    cartDiv.innerHTML += `
      <div class="cart-item">
        <div>
          <strong>${item.name}</strong><br>
          ${RUPEE}${item.price.toFixed(2)} x ${item.qty}
        </div>
        <div class="cart-controls">
          <button onclick="changeQty(${item.id},-1)">-</button>
          <button onclick="changeQty(${item.id},1)">+</button>
          <button onclick="removeItem(${item.id})">Remove</button>
        </div>
      </div>
    `;
  });

  count.textContent = items;
  totalSpan.textContent = total.toFixed(2);
}

function changeQty(id,change){
  const item = cart.find(c=>c.id===id);
  if(!item) return;
  item.qty += change;
  if(item.qty <= 0) cart = cart.filter(c=>c.id!==id);
  updateCart();
  refreshItemCards();
}

function removeItem(id){
  cart = cart.filter(c=>c.id!==id);
  updateCart();
  refreshItemCards();
}

function placeOrder(){
  const selected = document.querySelector('input[name="payment"]:checked');
  const method = selected ? selected.value : "UPI";
  if(!cart.length){
    alert("Your cart is empty. Add items before placing the order.");
    return;
  }
  alert(`Order placed successfully with ${method}. You can track it in the Tracking tab.`);
  showPage("tracking");
}

const trackingSteps = [
  {text:"Order accepted by restaurant",eta:"22 mins",progress:12,x:12,y:20,location:"Restaurant confirmed your order at 12th Main Road.",speed:0},
  {text:"Food is being prepared",eta:"19 mins",progress:24,x:17,y:26,location:"Rider waiting near Jyoti Nivas Junction.",speed:12},
  {text:"Delivery partner picked up your order",eta:"15 mins",progress:40,x:27,y:36,location:"Rider picked up order and exited 80 Feet Road.",speed:24},
  {text:"Rider crossed Sony Signal",eta:"11 mins",progress:58,x:41,y:46,location:"Bike crossed Sony Signal toward Intermediate Ring Road.",speed:31},
  {text:"Rider reached Forum side",eta:"8 mins",progress:75,x:55,y:56,location:"Rider nearing Forum Mall stretch.",speed:26},
  {text:"Rider is near your location",eta:"4 mins",progress:90,x:68,y:64,location:"Rider entered Koramangala 5th Block lane.",speed:18},
  {text:"Order delivered",eta:"0 mins",progress:100,x:78,y:70,location:"Order delivered at your location. Enjoy your meal!",speed:0}
];

let trackIndex = 0;
function updateTracking(){
  const status = document.getElementById("trackStatus");
  const eta = document.getElementById("eta");
  const fill = document.getElementById("trackFill");
  const riderPin = document.getElementById("riderPin");
  const mapLocation = document.getElementById("mapLocation");
  const mapSpeed = document.getElementById("mapSpeed");
  if(!status || !eta || !fill || !riderPin || !mapLocation || !mapSpeed) return;

  const step = trackingSteps[trackIndex];
  status.textContent = step.text;
  eta.textContent = step.eta;
  fill.style.width = `${step.progress}%`;
  riderPin.style.left = `${step.x}%`;
  riderPin.style.top = `${step.y}%`;
  riderPin.style.transform = `rotate(${(trackIndex * 12) - 18}deg)`;
  mapLocation.textContent = step.location;
  mapSpeed.textContent = `Bike speed: ${step.speed} km/h`;
  trackIndex = (trackIndex + 1) % trackingSteps.length;
}

applyHomeFilters();
updateTracking();
setInterval(updateTracking, 2600);
</script>

</body>
</html>
